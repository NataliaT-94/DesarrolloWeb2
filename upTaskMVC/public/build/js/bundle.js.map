{"version":3,"sources":["app.js","tareas.js"],"names":["mobileMenuBtn","document","querySelector","cerrarMenuBtn","sidebar","addEventListener","classList","add","setTimeout","remove","anchoPantalla","body","clientWidth","window","BASE","APP_BASE","APP_URL","replace","tareas","filtradas","inicializar","nuevaTareaBtn","mostrarFormulario","querySelectorAll","forEach","radio","filtrarTareas","contenedorTareas","proyectoId","obtenerProyecto","obtenerTareas","console","log","e","filtro","target","value","filter","tarea","estado","mostrarTareas","async","id","url","encodeURIComponent","respuesta","fetch","resultado","json","error","limpiarTareas","totalPendientes","totalCompletas","arrayTareas","length","textNoTareas","createElement","textContent","appendChild","estados","0","1","contenedorTarea","dataset","tareaId","nombreTarea","nombre","ondblclick","opcionesDiv","btnEstadoTarea","toLowerCase","estadoTarea","cambiarEstadoTarea","btnEliminarTarea","idTarea","confirmarEliminarTarea","pendientesRadio","disabled","completasRadio","editar","modal","innerHTML","preventDefault","contains","trim","mostrarAlerta","actualizarTarea","agregarTarea","mensaje","tipo","referencia","alertaPrevia","alerta","parentElement","insertBefore","nextElementSibling","datos","FormData","append","method","tareaObj","String","nuevoEstado","Swal","fire","map","tareaMemoria","title","showCancelButton","confirmButtonText","cancelButtonText","then","result","isConfirmed","eliminarTarea","params","URLSearchParams","location","search","get","listadoTareas","firstChild","removeChild"],"mappings":"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","file":"bundle.js","sourcesContent":["\r\n    const mobileMenuBtn = document.querySelector('#mobile-menu');\r\n    const cerrarMenuBtn = document.querySelector('#cerrar-menu');\r\n    const sidebar = document.querySelector('.sidebar');\r\n    \r\n    if(mobileMenuBtn){\r\n        mobileMenuBtn.addEventListener('click', function(){\r\n            sidebar.classList.add('mostrar');\r\n        });\r\n    }\r\n    \r\n    if(cerrarMenuBtn){\r\n        cerrarMenuBtn.addEventListener('click', function(){\r\n            sidebar.classList.add('ocultar');\r\n\r\n            setTimeout(() => {\r\n                sidebar.classList.remove('mostrar');\r\n                sidebar.classList.remove('ocultar');\r\n            }, 1000);\r\n        });\r\n    }\r\n\r\n    //Elimina la clase de mostrar, en tamaÃ±o de tablet y mayores\r\n    const anchoPantalla = document.body.clientWidth;\r\n\r\n    window.addEventListener('resize', function(){\r\n    const anchoPantalla = document.body.clientWidth;\r\n        if(anchoPantalla >= 768){\r\n            sidebar.classList.remove('mostrar');\r\n        }\r\n    })\r\n    ","// Base URL inyectable desde el servidor (layout). Fallback seguro a '/'\r\nconst BASE = (window.APP_BASE || window.APP_URL || '/').replace(/\\/?$/, '/');\r\n\r\n// obtenerTareas();\r\nlet tareas = [];\r\nlet filtradas = [];\r\n\r\ninicializar();\r\n\r\nfunction inicializar() {\r\n  // BotÃ³n \"Agregar tarea\" (si existe en esta vista)\r\n  const nuevaTareaBtn = document.querySelector('#agregar-tarea');\r\n  if (nuevaTareaBtn) {\r\n    nuevaTareaBtn.addEventListener('click', function () {\r\n      mostrarFormulario();\r\n    });\r\n  }\r\n\r\n  // Filtros (si existen)\r\n  const filtros = document.querySelectorAll('#filtros input[type=\"radio\"]');\r\n  filtros.forEach((radio) => {\r\n    radio.addEventListener('input', filtrarTareas);\r\n  });\r\n\r\n  // Solo intentamos cargar tareas si hay contenedor y hay id/url de proyecto\r\n  const contenedorTareas = document.querySelector('#listado-tareas');\r\n  const proyectoId = obtenerProyecto();\r\n  if (contenedorTareas && proyectoId) {\r\n    obtenerTareas();\r\n  } else if (!proyectoId) {\r\n    console.log('ðŸ“„ No hay ID de proyecto en esta pÃ¡gina.');\r\n  }\r\n}\r\n\r\n\r\n//Boton para mostrar el Modal de Agregar tarea\r\n\r\n// const nuevaTareaBtn = document.querySelector('#agregar-tarea');\r\n// if (nuevaTareaBtn) {\r\n//     nuevaTareaBtn.addEventListener('click', function(){\r\n//         mostrarFormulario();\r\n//     });\r\n// }\r\n\r\n\r\n// const nuevaTareaBtn = document.querySelector('#agregar-tarea');\r\n// nuevaTareaBtn.addEventListener('click', function(){\r\n//     mostrarFormulario();\r\n// } );\r\n\r\n//Filtros de Busqueda\r\n// const filtros = document.querySelectorAll('#filtros input[type=\"radio\"]');\r\n// filtros.forEach(radio => {\r\n//     radio.addEventListener('input', filtrarTareas);\r\n// });\r\n\r\nfunction filtrarTareas(e){\r\n    const filtro = e.target.value;\r\n\r\n    if(filtro !== ''){\r\n        filtradas = tareas.filter(tarea => tarea.estado === filtro);\r\n        \r\n    } else {\r\n        filtradas = [];\r\n        \r\n    }\r\n    mostrarTareas();\r\n}\r\n\r\n\r\nasync function obtenerTareas(){\r\n    try {\r\n        const id = obtenerProyecto();\r\n        if (!id) return;\r\n        const url = `${BASE}api/tareas?id=${encodeURIComponent(id ?? '')}`;\r\n\r\n\r\n        // console.log(url);\r\n        // console.log('BASE actual:', BASE);\r\n\r\n        \r\n        const respuesta = await fetch(url);\r\n\r\n        const resultado = await respuesta.json();\r\n        \r\n        tareas = resultado.tareas;\r\n\r\n        // const proyectoId = obtenerProyecto();\r\n\r\n        // if (proyectoId) {\r\n        //     const url = `${BASE}api/tareas?id=${proyectoId}`;\r\n        //     console.log('URL del fetch:', url);\r\n\r\n        //     fetch(url)\r\n        //         .then(res => res.json())\r\n        //         .then(data => console.log('âœ… Tareas:', data))\r\n        //         .catch(err => console.error('Error al cargar tareas:', err));\r\n                \r\n        // } else {\r\n        //     console.log('ðŸ“„ No hay ID de proyecto en esta pÃ¡gina.');\r\n        // }\r\n\r\n        \r\n        mostrarTareas();\r\n    } catch (error) {\r\n        console.log(error);\r\n        \r\n        \r\n    }\r\n}\r\n\r\nfunction mostrarTareas(){\r\n\r\n    limpiarTareas();\r\n    totalPendientes();\r\n    totalCompletas();\r\n\r\n    const arrayTareas = filtradas.length ? filtradas : tareas;\r\n    \r\n    if(arrayTareas.length === 0){\r\n        const contenedorTareas = document.querySelector('#listado-tareas');\r\n        const textNoTareas = document.createElement('LI');\r\n        textNoTareas.textContent = \"No hay Tareas\";\r\n        textNoTareas.classList.add('no-tareas');\r\n\r\n        contenedorTareas.appendChild(textNoTareas);\r\n    }\r\n\r\n    const estados = {\r\n        0: 'Pendiente',\r\n        1: 'Completa'\r\n    }\r\n\r\n    arrayTareas.forEach(tarea => {\r\n        const contenedorTarea = document.createElement('LI');\r\n        contenedorTarea.dataset.tareaId = tarea.id;\r\n        contenedorTarea.classList.add('tarea');\r\n\r\n        const nombreTarea = document.createElement('P');\r\n        nombreTarea.textContent = tarea.nombre;\r\n        nombreTarea.ondblclick = function(){\r\n            // mostrarFormulario(editar = true, {...tarea});\r\n            mostrarFormulario(true, { ...tarea });\r\n\r\n        }\r\n\r\n        const opcionesDiv = document.createElement('DIV');\r\n        opcionesDiv.classList.add('opciones');\r\n\r\n        //Botones\r\n        const btnEstadoTarea = document.createElement('BUTTON');\r\n        btnEstadoTarea.classList.add('estado-tarea');\r\n        btnEstadoTarea.classList.add(`${estados[tarea.estado].toLowerCase()}`);\r\n        btnEstadoTarea.textContent = estados[tarea.estado];\r\n        btnEstadoTarea.dataset.estadoTarea = tarea.estado;\r\n        btnEstadoTarea.ondblclick = function(){//doble click\r\n            cambiarEstadoTarea({...tarea});//sacamos una copia del objeto la cual vamos a modificar\r\n            \r\n        }\r\n\r\n        const btnEliminarTarea = document.createElement('BUTTON');\r\n        btnEliminarTarea.classList.add('eliminar-tarea');\r\n        btnEliminarTarea.dataset.idTarea = tarea.id;\r\n        btnEliminarTarea.textContent = 'Eliminar';\r\n        btnEliminarTarea.ondblclick = function(){\r\n            confirmarEliminarTarea({...tarea});\r\n        }\r\n\r\n        opcionesDiv.appendChild(btnEstadoTarea);\r\n        opcionesDiv.appendChild(btnEliminarTarea);\r\n\r\n        contenedorTarea.appendChild(nombreTarea);\r\n        contenedorTarea.appendChild(opcionesDiv);\r\n\r\n        const listadoTareas = document.querySelector('#listado-tareas');\r\n        listadoTareas.appendChild(contenedorTarea);\r\n        \r\n    }); \r\n}\r\n\r\nfunction totalPendientes(){\r\n    const totalPendientes = tareas.filter(tarea => tarea.estado === \"0\");\r\n    const pendientesRadio = document.querySelector('#pendientes');\r\n\r\n    if(totalPendientes.length === 0){\r\n        pendientesRadio.disabled = true;\r\n    } else {\r\n        pendientesRadio.disabled = false;\r\n\r\n    }\r\n}\r\n\r\nfunction totalCompletas(){\r\n    const totalCompletas = tareas.filter(tarea => tarea.estado === \"1\");\r\n    const completasRadio = document.querySelector('#completadas');\r\n\r\n    if(totalCompletas.length === 0){\r\n        completasRadio.disabled = true;\r\n    } else {\r\n        completasRadio.disabled = false;\r\n\r\n    }\r\n}\r\n\r\nfunction mostrarFormulario(editar = false, tarea = {}){\r\n    console.log('mostrar form..');\r\n    \r\n    const modal = document.createElement('DIV');\r\n    modal.classList.add('modal');\r\n    modal.innerHTML = `\r\n        <form class=\"formulario nueva-tarea\">\r\n            <legend>${editar ? 'Editar Tarea' : 'AÃ±ade una nueva tarea'}</legend>\r\n            <div class=\"campo\">\r\n                <label>Tarea</label>\r\n                <input type=\"text\" name=\"tarea\" placeholder=\"${tarea.nombre ? 'Edita la Tarea' : 'AÃ±adir Tarea al Proyecto Actual'}\" id=\"tarea\" value=\"${tarea.nombre ? tarea.nombre : ''}\"/>\r\n            </div>\r\n            <div class=\"opciones\">\r\n                <input type=\"submit\" class=\"submit-nueva-tarea\" value=\"${tarea.nombre ? 'Guardar Cambios' : 'AÃ±adir Tarea'}\"/>\r\n                <button type=\"button\" class=\"cerrar-modal\">Cancelar</button>\r\n            </div>\r\n        </form>\r\n    `;\r\n    \r\n    setTimeout(() => {\r\n         const formulario = document.querySelector('.formulario');\r\n         formulario.classList.add('animar');\r\n    }, 0);\r\n\r\n    modal.addEventListener('click', function(e){\r\n        e.preventDefault();\r\n\r\n        if(e.target.classList.contains('cerrar-modal')){//contains: verifica que el elemnto html contenga cerrar-modal\r\n            const formulario = document.querySelector('.formulario');\r\n            formulario.classList.add('cerrar');    \r\n\r\n             setTimeout(() => {\r\n                modal.remove();\r\n            }, 500);\r\n        }\r\n\r\n        if(e.target.classList.contains('submit-nueva-tarea')){//contains: verifica que el elemnto html contenga cerrar-modal\r\n            const nombreTarea = document.querySelector('#tarea').value.trim();//trim: elimini el espacio al inicio y al final\r\n\r\n                if(nombreTarea === ''){\r\n                    //Mostrar una alerta de error\r\n                    mostrarAlerta('El nombre de la tarea es Obligatorio', 'error', document.querySelector('.formulario legend'));\r\n                    return;\r\n                }\r\n                if(editar){\r\n                    tarea.nombre = nombreTarea;\r\n                    actualizarTarea(tarea);\r\n                    \r\n                } else {\r\n                    agregarTarea(nombreTarea);\r\n                    \r\n                }\r\n        }\r\n    })\r\n\r\n    document.querySelector('.dashboard').appendChild(modal);\r\n}\r\n\r\n\r\n    \r\n    //Muestra un mensaje en la interfaz\r\n    function mostrarAlerta(mensaje, tipo, referencia){\r\n\r\n        //Previene la creacion de multiples alertas\r\n        const alertaPrevia = document.querySelector('.alerta');\r\n\r\n        if(alertaPrevia){\r\n            alertaPrevia.remove();\r\n        }\r\n\r\n        const alerta = document.createElement('DIV');\r\n        alerta.classList.add('alerta', tipo);\r\n        alerta.textContent = mensaje;\r\n\r\n        //Inserta la alerta antes del legend\r\n        referencia.parentElement.insertBefore(alerta, referencia.nextElementSibling);\r\n\r\n        //Eliminar la alerta despues de unos segundos\r\n        setTimeout(() => {\r\n            alerta.remove();\r\n        }, 5000);\r\n\r\n    }\r\n\r\n    //Consultar el servidor para aÃ±adir una nueva tarea al proyecto actual\r\n    async function agregarTarea(tarea){\r\n      //Construir la peticion\r\n       const datos = new FormData();\r\n        datos.append('nombre', tarea);        \r\n        datos.append('proyectoId', obtenerProyecto());        \r\n\r\n        try{\r\n            // const url = 'http://localhost:3000/api/tarea';\r\n            const url = `${BASE}api/tarea`;\r\n            const respuesta = await fetch(url, {\r\n                method: 'POST',\r\n                body: datos\r\n\r\n            });\r\n           const resultado = await respuesta.json();\r\n\r\n           mostrarAlerta(resultado.mensaje, resultado.tipo, document.querySelector('.formulario legend'));\r\n            \r\n           if(resultado.tipo === 'exito'){\r\n                const modal = document.querySelector('.modal');\r\n                setTimeout(() => {\r\n                    modal.remove();\r\n                }, 1000);  \r\n\r\n                //Agregar el objeto de tarea al global de tareas\r\n                const tareaObj = {\r\n                    id: String(resultado.id),\r\n                    nombre: tarea,\r\n                    estado: \"0\",\r\n                    proyectoId: resultado.proyectoId\r\n                }\r\n\r\n                tareas =[...tareas, tareaObj];//tengo una copia de las tareas, y le agrega la nueva tarea                \r\n                mostrarTareas();\r\n            }\r\n\r\n        } catch(error) {\r\n            console.log(error);\r\n            \r\n        }\r\n    }\r\n\r\n    function cambiarEstadoTarea(tarea){\r\n\r\n        const nuevoEstado = tarea.estado === \"1\" ? \"0\" : \"1\";\r\n        tarea.estado = nuevoEstado;\r\n        actualizarTarea(tarea);\r\n    }\r\n\r\n    async function actualizarTarea(tarea){\r\n        const {estado, id, nombre} = tarea;\r\n\r\n        const datos = new FormData;\r\n        datos.append('id',id);\r\n        datos.append('nombre',nombre);\r\n        datos.append('estado',estado);\r\n        datos.append('proyectoId',obtenerProyecto());\r\n\r\n        // for(let valor of datos.values()){ para poder ver los datos en el formdata antes de enviar al servidor\r\n        //     console.log(valor);\r\n        // }\r\n        try {\r\n            // const url = 'http://localhost:3000/api/tarea/actualizar';  \r\n            const url = `${BASE}api/tarea/actualizar`; \r\n            const respuesta =  await fetch(url, {\r\n                method: 'POST',\r\n                body: datos\r\n            });\r\n            const resultado = await respuesta.json();\r\n            \r\n            if(resultado.respuesta.tipo === 'exito'){\r\n                Swal.fire(\r\n                    resultado.respuesta.mensaje,\r\n                    resultado.respuesta.mensaje,\r\n                    'success'\r\n                );\r\n\r\n                const modal = document.querySelector('.modal');\r\n                if(modal){\r\n                    modal.remove();\r\n                }\r\n                tareas = tareas.map(tareaMemoria =>{//map crea un arreglo ya con la actualizacion\r\n                    if(tareaMemoria.id === id){\r\n                        tareaMemoria.estado = estado;\r\n                        tareaMemoria.nombre = nombre;\r\n                    }\r\n                    return tareaMemoria;\r\n                });\r\n                mostrarTareas();   \r\n            }\r\n             \r\n        } catch (error) {\r\n            console.log(error);\r\n            \r\n        }\r\n    }\r\n\r\n    function confirmarEliminarTarea(tarea){\r\n        Swal.fire({\r\n            title: \"Eliminar Tarea?\",\r\n            showCancelButton: true,\r\n            confirmButtonText: 'Si',\r\n            cancelButtonText: 'No'\r\n          }).then((result) => {\r\n            if (result.isConfirmed) {\r\n                eliminarTarea(tarea);\r\n            }\r\n          });\r\n    }\r\n    async function eliminarTarea(tarea) {\r\n        const {estado, id, nombre} = tarea;\r\n\r\n        const datos = new FormData;\r\n        datos.append('id',id);\r\n        datos.append('nombre',nombre);\r\n        datos.append('estado',estado);\r\n        datos.append('proyectoId',obtenerProyecto());\r\n\r\n        try {\r\n            // const url = 'http://localhost:3000/api/tarea/eliminar';  \r\n            const url = `${BASE}api/tarea/eliminar`; \r\n            const respuesta =  await fetch(url, {\r\n                method: 'POST',\r\n                body: datos\r\n            });\r\n            const resultado = await respuesta.json();\r\n\r\n            if(resultado.resultado){\r\n                // mostrarAlerta(\r\n                //     resultado.mensaje, \r\n                //     resultado.tipo, \r\n                //     document.querySelector('.contenedor-nueva-tarea')\r\n                // );\r\n                Swal.fire('Eliminado!', resultado.mensaje, 'success');\r\n\r\n                tareas = tareas.filter(tareaMemoria => tareaMemoria.id !== tarea.id);//genera una copia y solo trae todas que sean diferentes al id que seleccione\r\n                mostrarTareas();\r\n            }\r\n            \r\n        } catch (error) {\r\n            console.log(error);\r\n            \r\n        }\r\n    }\r\n\r\n    // function obtenerProyecto(){\r\n    //     const proyectoParams = new URLSearchParams(window.location.search);\r\n    //     const proyecto = Object.fromEntries(proyectoParams.entries());//sirve para iterar objetos como el formdata/entries trae los datos del obje\r\n    //     return proyecto.id;\r\n        \r\n    // }\r\n\r\n    function obtenerProyecto(){\r\n        const params = new URLSearchParams(window.location.search);\r\n        // El backend espera ?id= con el valor de url del proyecto, pero tu vista navega con ?url=\r\n        return params.get('id') || params.get('url') || null;\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n    function limpiarTareas(){\r\n        const listadoTareas = document.querySelector('#listado-tareas');\r\n        // listadoTareas.innerHTML = '';\r\n\r\n        while(listadoTareas.firstChild){\r\n            listadoTareas.removeChild(listadoTareas.firstChild);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\r\n"]}